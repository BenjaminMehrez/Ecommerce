{% extends 'layouts/blank.html' %}
{% load price_filters %}
{% load static %}


{% block content %}

<div class="flex min-h-screen bg-gray-50">

    <div class="hidden md:block w-64 bg-white shadow-sm">
        <div class="px-4 py-6">
            <div class="flex items-center gap-4 ">
                <img src="{% static 'images/logo-black.svg' %}" alt="E-commerce" class="h-8">
                <h2 class="flex mt-2">E-commerce</h2>
            </div>
            <nav class="mt-6 space-y-2">
                <a href="{% url 'dashboard-admin' %}" class="flex items-center px-4 py-2 text-gray-700 rounded-lg">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                    </svg>
                    Panel
                </a>
                <a href="{% url 'products' %}" class="flex items-center px-4 py-2 text-gray-700 rounded-lg">
                    <img class="w-5 h-5 mr-3" src="{% static 'images/logo-black.svg' %}" alt="">
                    Productos
                </a>
                <a href="{% url 'orders' %}" class="flex items-center px-4 py-2 text-gray-900 bg-gray-100 font-medium rounded-lg">
                    <svg class="w-5 h-5 mr-3" viewBox="0 0 24 24" fill="none" xmlns="https://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path d="M3.17004 7.43994L12 12.5499L20.77 7.46991" stroke="#292D32" stroke-width="1.5"
                                stroke-linecap="round" stroke-linejoin="round"></path>
                            <path d="M12 21.6099V12.5399" stroke="#292D32" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round"></path>
                            <path
                                d="M9.92999 2.48L4.59 5.45003C3.38 6.12003 2.39001 7.80001 2.39001 9.18001V14.83C2.39001 16.21 3.38 17.89 4.59 18.56L9.92999 21.53C11.07 22.16 12.94 22.16 14.08 21.53L19.42 18.56C20.63 17.89 21.62 16.21 21.62 14.83V9.18001C21.62 7.80001 20.63 6.12003 19.42 5.45003L14.08 2.48C12.93 1.84 11.07 1.84 9.92999 2.48Z"
                                stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                            <path d="M17 13.24V9.58002L7.51001 4.09998" stroke="#292D32" stroke-width="1.5"
                                stroke-linecap="round" stroke-linejoin="round"></path>
                        </g>
                    </svg>
                    Ordenes
                </a>
            </nav>
        </div>
    </div>

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-2xl font-semibold text-gray-900">Detalle del orden</h1>
            </div>

            <!-- Date and Order ID -->
            <div class="mb-6 flex items-center text-sm text-gray-500">
                <svg class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" />
                </svg>
                {{ order.order_date }}
                <span class="ml-4">Orden ID: # {{ order.oid }}</span>
            </div>

            <!-- Status and Save Button -->
            <form method="POST" action="{% url 'change-order-status' order.oid %}" class="mb-8 flex justify-end space-x-4">
                {% csrf_token %}
                <select name="status" class="rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary">
                    <option value="procesando">Cambiar Estado</option>
                    <option value="procesando">Procesando</option>
                    <option value="enviado">Enviado</option>
                    <option value="entregado">Entregado</option>
                </select>
                <button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
                    Guardar
                </button>
            </form>

            <!-- Info Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Customer Info -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="h-8 w-8 bg-emerald-100 rounded-full flex items-center justify-center">
                            <svg class="h-5 w-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <h2 class="ml-3 text-lg font-medium text-gray-900">Cliente</h2>
                    </div>
                    <div class="text-sm text-gray-500">
                        <div class="flex gap-2">
                            <span>Nombre Completo:</span>
                            <p class="font-medium text-gray-800">{{ order.first_name }}</p>
                            <p class="font-medium text-gray-800">{{ order.last_name }}</p>
                        </div>
                        <span>Correo Electronico: </span><p class=" text-gray-800">{{ order.email }}</p>
                        Telefono: <p class="text-gray-800">{{ order.phone }}</p>
                    </div>
                </div>

                <!-- Order Info -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="h-8 w-8 bg-emerald-100 rounded-full flex items-center justify-center">
                            <svg class="h-5 w-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                        </div>
                        <h2 class="ml-3 text-lg font-medium text-gray-900">Información del orden</h2>
                    </div>
                    <div class="text-sm text-gray-500">
                        <p><span class="font-medium">Métedo de pago:</span> {{ order.shipping_method }}</p>
                        <p><span class="font-medium">Orden ID:</span> #{{ order.oid }}</p>
                        <p><span class="font-medium">Estado del orden:</span> {{ order.product_status|title }}</p>
                        <p><span class="font-medium">Estado del pago:</span> 
                            {% if order.paid_status == True %}
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                Pagado
                            </span>
                            {% else %}
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                Sin Pagar
                            </span>
                            {% endif %}
                        </p>
                    </div>
                </div>

                <!-- Delivery Info -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <div class="flex items-center mb-4">
                        <div class="h-8 w-8 bg-emerald-100 rounded-full flex items-center justify-center">
                            <svg class="h-5 w-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                        </div>
                        <h2 class="ml-3 text-lg font-medium text-gray-900">Entregar a</h2>
                    </div>
                    <div class="text-sm text-gray-500">
                        <p>Dirrecíon: <span class=" text-gray-800">{{ order.address }}</span></p>
                        <p>Numero: <span class=" text-gray-800">{{ order.number }}</span></p>
                        <p>Codigo Postal: <span class=" text-gray-800">{{ order.zipcode }} </span> </p>
                        <p>Piso: <span class="text-gray-800">{{ order.level }}</span></p>
                        <p>Departamento: <span class=" text-gray-800">{{ order.departament }}</span></p>
                        <p>Provincia: <span class=" text-gray-800">{{ order.city }}, {{ order.country }}</span> </p>
                    </div>
                </div>
            </div>

            <!-- Order Items Table -->
            <div class="bg-white shadow overflow-hidden rounded-lg">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Producto
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Precio
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Cantidad
                            </th>
                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                SubTotal
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for item in order_items %}
                        <tr>
                            <td class="flex items-center gap-2 px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                <img class="h-10 w-10" src="{{ item.image }}" alt="">
                                {{ item.item }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                ${{ item.price|formato_precio }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm  text-gray-500">
                                {{ item.qty }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right">
                                ${{ item.total|formato_precio }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Order Summary -->
            <div class="mt-8">
                <dl class="space-y-4">
                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-600">Costo de envío</dt>
                        <dd class="text-sm font-medium text-gray-900">$ 0</dd>
                    </div>
                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-600">Descuento</dt>
                        <dd class="text-sm font-medium text-gray-900">$ {{ order.saved|formato_precio }}</dd>
                    </div>
                    <div class="flex items-center justify-between border-t border-gray-200 pt-4">
                        <dt class="text-base font-medium text-gray-900">Total</dt>
                        <dd class="text-base font-medium text-gray-900">$ {{ order.price|formato_precio }}</dd>
                    </div>
                </dl>
            </div>
    </div>

</div>


<div id="spinner" class="absolute top-2/4 left-2/4" hx-trigger="load">
    <svg class="htmx-indicator loader" width="35" height="35" viewBox="0 0 24 24" xmlns="https://www.w3.org/2000/svg"><path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25"/><path d="M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z"><animateTransform attributeName="transform" type="rotate" dur="0.75s" values="0 12 12;360 12 12" repeatCount="indefinite"/></path></svg>
</div>


{% endblock %}
